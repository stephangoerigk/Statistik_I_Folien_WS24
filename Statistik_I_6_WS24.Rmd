---
title: "Einheit 6"
subtitle: "âš”<br/>with xaringan"
author: "Prof. Dr. Stephan Goerigk"
institute: "RStudio, PBC"
date: "2016/12/12 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    css: [xaringan-themer.css, "hygge"]
    lib_dir: libs
    nature:
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'
    seal: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

library(tidyverse)
library(kableExtra)
library(ggplot2)
library(plotly)
library(htmlwidgets)
library(MASS)
library(ggpubr)
library(xaringanthemer)
library(xaringanExtra)

style_duo_accent(
  primary_color = "#621C37",
  secondary_color = "#EE0071",
  background_image = "blank.png"
)

xaringanExtra::use_xaringan_extra(c("tile_view"))

use_scribble(
  pen_color = "#EE0071",
  pen_size = 4
)

knitr::opts_chunk$set(
  fig.retina = TRUE,
  warning = FALSE,
  message = FALSE
)
```

name: Title slide
class: middle, left
<br><br><br><br><br><br><br>
# Statistik I
***
### Einheit 6: SchÃ¤tzungen und Stichprobenfehler
##### `r format(as.Date(data.frame(readxl::read_excel("Modul Quantitative Methoden I_Termine.xlsx"))$Datum), "%d.%m.%Y")[6]` | Prof. Dr. Stephan Goerigk

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Wiederholung:

**Inferenzstatistik: **

* Umfasst alle statistischen Verfahren, die es erlauben, trotz der InformationsunvollstÃ¤ndigkeit der Stichprobendaten Aussagen Ã¼ber eine Population zu treffen.

**Population: **

* Gesamtheit aller MerkmalstrÃ¤ger:innen, auf die eine Untersuchungsfrage gerichtet ist.

**Stichprobe: **

* Auswahl bestimmter MerkmalstrÃ¤ger:innen aus einer Population

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Wiederholung:

**Problem:**

* Wenn nur ein Teil der Grundgesamtheit erfasst wird, z.B. 100 Personen, ist die **Informationslage** in Bezug auf die Untersuchungsfrage **unvollstÃ¤ndig**. Wir kÃ¶nnen nicht einfach deskriptiv-statistische Methoden verwenden.

* Wie kann man trotzdem Aussagen treffen, die sich auf alle Personen der Grundgesamtheit beziehen, obwohl nur die Daten einer Stichprobe vorliegen?

***

**Idee:**

* Wir ziehen die Personen zufÃ¤llig aus der Population in die Stichprobe.

* Wir greifen auf mathematische Methoden zur Formalisierung von Zufallsprozessen zurÃ¼ck $\rightarrow$ Wahrscheinlichkeitstheorie

* Aus diesen ergeben sich Methoden, die RÃ¼ckschlÃ¼sse von der Stichprobe auf die Population erlauben $\rightarrow$ Inferenzstatistik

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Logik des SchlieÃŸens von Stichprobe auf Population (Einzelschritte folgen)

.center[
```{r eval = TRUE, echo = F, out.width = "900px"}
knitr::include_graphics("bilder/zfg.png")
```
]

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Einfache Zufallsstichprobe:

**Jetzt:** ZufÃ¤llige Ziehung von n Personen aus einer Population von $N$ Personen (mit â€ZurÃ¼cklegenâ€œ).

* $n$ wird hierbei Stichprobenumfang genannt.

* Dieser Vorgang ist ein Zufallsexperiment:
  * Wir wissen im Voraus nicht, welche Personen gezogen werden
  * Die Ergebnismenge $Î©$ ist die Menge aller mÃ¶glichen Stichproben mit $n$ Personen.

* Wir setzen voraus, dass jede Person in der Population bei jeder der $n$ Ziehungen die gleiche Wahrscheinlichkeit hat, in die Stichprobe gezogen zu werden.

* Wir setzen zudem voraus, dass die $n$ Personen unabhÃ¤ngig voneinander gezogen werden.
* Zufallsstichproben mit diesen beiden Eigenschaften nennt man einfache Zufallsstichproben.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Einfache Zufallsstichprobe - Probleme:

Leider werden in der Praxis oft keine einfachen Zufallsstichproben gezogen. HÃ¤ufig auftretende Probleme:

**1. Fehlende ReprÃ¤sentativitÃ¤t:**
<small>
* Eine bestimmte Teilgruppe von Personen in der Population hat eine hÃ¶here
Wahrscheinlichkeit, in die Stichprobe gezogen zu werden als andere Personen.
* Beispiel: Nur Personen die Psychologie studieren haben eine echt positive
Wahrscheinlichkeit gezogen werden.
* Folge: Die interessierende MaÃŸzahl in der Population entspricht nicht mehr dem
Parameter der jeweiligen Wahrscheinlichkeitsverteilung. Inferenzstatistische Verfahren, die hierauf aufbauen, sind verzerrt.

</small>

**2. AbhÃ¤ngigkeit der Ziehungen:**
<small>
* Die Ziehungen der Personen sind nicht unabhÃ¤ngig voneinander.
* Beispiel: sog. geschachtelte Stichproben: ZufÃ¤lliges Ziehen einer Schule, dann zufÃ¤lliges Ziehen von Personen aus dieser Schule.
* Folge: Die Zufallsvariablen sind nicht unabhÃ¤ngig, Inferenzstatistische Verfahren die hierauf aufbauen, sind verzerrt.
* Falls die Art der AbhÃ¤ngigkeit bekannt ist, kann dies mithilfe statistischer Methoden (hierarchische Modellierung) ausgeglichen werden.

</small>

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Zusammenfassung:

* Wenn wir herausfinden wollen, was der mittlere IQ in der Population ist, mÃ¼ssen wir lediglich herausfinden, welchen Wert der Parameter $ğœ‡$ hat.

* Wenn wir herausfinden wollen, was die empirische Varianz des IQs in der Population ist, mÃ¼ssen wir lediglich herausfinden, welchen Wert der Parameter $ğœ^2$ hat.

* Auch in diesem Fall kÃ¶nnen wir also das Problem der Bestimmung von deskriptivstatistischen MaÃŸzahlen in der Population $(\bar{x}_{IQ}$ und $s^2_{empIQ})$ komplett in die
Wahrscheinlichkeitstheorie verlagern und somit alle Mittel verwenden, die uns diese zur VerfÃ¼gung stellt.

$\rightarrow$ Um (nicht in GÃ¤nze messbare) Populationen zu beschreiben, reicht es die zentralen Parameter einer Wahrscheinlichkeitsverteilung zu kennen (solange die Variablen sich ihren Annahmen entsprechend verteilen).

**FRAGE:** Wie kommen wir an die Werte $ğœ‡$ und $ğœ^2$?

**ANTWORT:** Wir schÃ¤tzen sie auf Basis der Stichprobe (Inferenzstatistik)!

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Inferenzstatistik:

* Wir haben gesehen, dass sich Aussagen Ã¼ber Populationen im Fall von einfachen Zufallsstichproben auf Aussagen Ã¼ber Parameter von Wahrscheinlichkeitsverteilungen reduzieren lassen.

* **Aber:** Dies hat das Problem des RÃ¼ckschlusses von Stichproben auf Populationen erst einmal nur in die Wahrscheinlichkeitstheorie verlagert.

* Es ist immer noch unklar, wie man von Stichproben zu Aussagen Ã¼ber Parameter von Wahrscheinlichkeitsverteilungen gelangt.

* Dies ist Gegenstand der Inferenzstatistik.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Inferenzstatistik:

Je nach Fragestellung, d.h. je nach Art der Aussage, die Ã¼ber einen Parameter getroffen werden soll, lassen sich inferenzstatistische Methoden zwei Gebieten zuordnen:

<small>

**1. ParameterschÃ¤tzung:**
  * Fragestellung: Welchen konkreten Wert hat ein Parameter?
  * Beispiele:
    * Welchen Wert hat $ğœ‹$?
    * Welche Werte haben $ğœ‡$ und $ğœ^2$?
  * Resultate von ParameterschÃ¤tzungen sind konkrete Zahlen oder Intervalle.
  
**2. Statistische Hypothesentests:**
  * Fragestellung: Entspricht ein Parameter einem vorgegebenen Wert oder liegt er in einem vorgegebenen Bereich?
  * Beispiele:
    * Ist $ğœ‹=0.5$?
    * Ist $ğœ‡= 100$?
    * Ist $ğœ^2>10$?
  * Das Resultat eines statistischen Hypothesentests ist eine Ja/Nein-Antwort.

</small>

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### ParameterschÃ¤tzung:

Ziel der ParameterschÃ¤tzung: Auf der Basis einer einfachen Zufallsstichprobe eine Aussage darÃ¼ber treffen, welchen konkreten Wert ein Parameter hat.

Man unterscheidet in der ParameterschÃ¤tzung zwischen

**1. PunktschÃ¤tzung:**
  * Ergebnis einer PunktschÃ¤tzung ist eine konkrete Zahl.
  * Beispiel: Wir gehen auf Basis unserer Stichprobe davon aus, dass der Parameter $ğœ‹$ gleich 0.45 ist.

**2. IntervallschÃ¤tzung**
  * Ergebnis einer IntervallschÃ¤tzung ist ein Intervall von Zahlen.
  * Beispiel: Wir gehen auf Basis unserer Stichprobe davon aus, dass der Parameter $ğœ‡$ im Bereich zwischen 101 und 108 liegt.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### ParameterschÃ¤tzung:

* Zur Erinnerung (sehr wichtig!): Aussagen Ã¼ber Parameter sind im Fall von einfachen Zufallsstichproben gleichbedeutend mit Aussagen Ã¼ber die uns eigentlich interessierenden deskriptivstatistischen MaÃŸzahlen in der Population:

**PunktschÃ¤tzung:**

* â€Wir gehen auf Basis unserer Stichprobe davon aus, dass der Parameter $ğœ‹$ gleich 0.45 ist.â€œ ist gleichbedeutend mit â€Wir gehen auf Basis unserer Stichprobe davon aus, dass die relative HÃ¤ufigkeit der uns interessierenden MesswertausprÃ¤gung in der Population gleich 0.45 ist.â€œ

**IntervallschÃ¤tzung**

* â€Wir gehen auf Basis unserer Stichprobe davon aus, dass der Parameter $ğœ‡$ im Bereich zwischen 101 und 108 liegt.â€œ ist gleichbedeutend mit â€Wir gehen auf Basis unserer Stichprobe davon aus, dass der Mittelwert der uns interessierenden stetigen Variable in der Population im Bereich zwischen 101 und 108 liegt.â€œ

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

Wir interessieren uns fÃ¼r eine deskriptivstatistische MaÃŸzahl in einer Population. 

* Beispiel 1 (diskret):
  * die relative HÃ¤ufigkeit $h_{A}$ der AngststÃ¶rung in der Population
* Beispiel 2 (stetig):
  * den Mittelwert $\bar{x}_{IQ}$ des IQs in der Population
  * die empirische Varianz $s^2_{empIQ}$ des IQs in der Population 
  
* Wir ziehen eine einfache Zufallsstichprobe und betrachten die  Zufallsvariablen $ğ‘‹_{1}, ğ‘‹_{2}, ..., ğ‘‹_{n}$ mit ihren Realisationen $x_{1}, x_{2}, ..., x_{n}$ (dies sind die Messwerte der Personen in der Stichprobe).

* Diese ZVs weisen eine Wahrscheinlichkeitsverteilung auf, deren Parameter jeweils den uns interessierenden deskriptivstatistischen MaÃŸzahlen in der Population entsprechen:
  * Beispiel 1: $ğœ‹ = h_{A}$
  * Beispiel 2: $ğœ‡=\bar{x}_{IQ}$ und $ğœ^2=s^2_{empIQ}$

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

* Wir wollen auf Basis der Realisationen der ZVs fÃ¼r jeden Parameter jeweils einen SchÃ¤tzwert bestimmen

* SchÃ¤tzwert = Wert, von dem wir auf der Basis unserer Stichprobe davon ausgehen, dass er â€mÃ¶glichst naheâ€œ an dem wahren Parameterwert bzw. dem wahren Wert der MaÃŸzahl in der Population liegt.

**Naheliegende Idee:** 

* Wir verwenden als SchÃ¤tzwert einfach zunÃ¤chst die entsprechende deskriptivstatistische MaÃŸzahl in der Stichprobe.

* Ob diese SchÃ¤tzungen unseren qualitativen AnsprÃ¼chen genÃ¼gen, muss sich aber noch herausstellen.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

.pull-left[
.center[
```{r echo=FALSE, out.width="450px", out.height="450px"}

df <- data.frame(PF = rnorm(100000, mean = 100, sd = 15))
ggplot(df, aes(x = PF)) + 
    # geom_histogram(aes(y =..density..),
    #                breaks = seq(50, 150, by = 2), 
    #                colour = "black", 
    #                fill = "white", bins = 100) +
  ggtitle("Wahrscheinlichkeitsfunktion \n (N~Î¼=?, Ïƒ=?)") +
  scale_x_continuous(breaks = 100, labels = c("Î¼ = ?")) +
  stat_function(fun = dnorm, args = list(mean = mean(df$PF), sd = sd(df$PF))) +
  labs(x = "IQ", y = "relative HÃ¤ufigkeit") +
   theme_classic() +
  theme(text = element_text(size = 25))
```
]
]

.pull-right[
.center[
```{r echo=FALSE, out.width="450px", out.height="450px"}

df <- data.frame(PF = rnorm(300, mean = 100, sd = 15))
ggplot(df, aes(x = PF)) + 
    geom_histogram(aes(y =..density..),
                   breaks = seq(50, 150, by = 2), 
                   colour = "black", 
                   fill = "white", bins = 100) +
  ggtitle("Werteverteilung in der  \nStichprobe") +
  geom_vline(xintercept = 100, colour = "red", linetype = "dashed") +
  scale_x_continuous( breaks = seq(50, 150, by = 50), labels = c("50", "xÌ„ = 100", "150")) +
  #stat_function(fun = dnorm, args = list(mean = mean(df$PF), sd = sd(df$PF))) +
  labs(x = "IQ", y = "relative HÃ¤ufigkeit") +
   theme_classic() +
  theme(text = element_text(size = 25))
```
]
]

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

Als naheliegender SchÃ¤tzwert fÃ¼r $ğœ‹$ die relative HÃ¤ufigkeit der AngststÃ¶rung in der Stichprobe:

$$h_{A}=\frac{H_{A}}{n}$$

Als naheliegender SchÃ¤tzwert fÃ¼r $ğœ‡$ den Mittelwert des IQs in der Stichprobe:

$$\bar{x}=\frac{\sum\limits _{i=1}^{n}x_{i}}{n}$$

Als naheliegender SchÃ¤tzwert fÃ¼r $ğœ^2$ die empirische Varianz des IQs in der Stichprobe:

$$s^2=\frac{\sum\limits _{i=1}^{n}(x_{i}-\bar{x})^2}{n}$$
---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

* Wie kÃ¶nnen wir feststellen, ob diese SchÃ¤tzwerte jeweils nahe an den wahren Parametern liegen?

* Antwort: FÃ¼r eine einzelne Stichprobe kÃ¶nnen wir dies leider nicht.

* Um zu bestimmen, wie weit ein einzelner SchÃ¤tzwert vom wahren Parameterwert entfernt ist, mÃ¼ssten wir ja den wahren Parameterwert schon kennen.

* Aber: Da die Ziehung der einfachen Zufallsstichprobe ein Zufallsexperiment ist, kÃ¶nnen wir uns anschauen, wie sich die SchÃ¤tzwerte verhalten wÃ¼rden, falls wir wiederholt eine solche einfache Zufallsstichprobe ziehen und die SchÃ¤tzwerte berechnen wÃ¼rden.

* Wir kÃ¶nnen auf diese Art und Weise herausfinden, wie gut unsere SchÃ¤tzungen â€im Durchschnittâ€œ sind.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

* Jedes Mal, wenn wir eine einfache Zufallsstichprobe der GrÃ¶ÃŸe $n$ aus der Population ziehen, gelangen andere Personen in unsere Stichprobe.

* Daher ergeben sich auch jedes Mal andere Realisationen $x_{1}, x_{2}, ..., x_{n}$ der Zufallsvariablen $ğ‘‹_{1}, ğ‘‹_{2}, ..., ğ‘‹_{n}$ und daher auch andere SchÃ¤tzwerte.

* Die SchÃ¤tzwerte unterliegen also Zufallsschwankungen.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

**Zufallsschwankungen im SchÃ¤tzwert (Beispiel 1 - AngsststÃ¶rungen)**

.center[
```{r eval = TRUE, echo = F, out.width = "750px"}
knitr::include_graphics("bilder/sampling1.png")
```
]

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

**Zufallsschwankungen im SchÃ¤tzwert (Beispiel 1 - AngsststÃ¶rungen)**

.pull-left[
* Die relative HÃ¤ufigkeit der AngsststÃ¶rung in dieser Population wÃ¤re $h_A=\frac{7}{50}=0.14$

* Angenommen, wir wÃ¼rden uns fÃ¼r $h_A$ in dieser Population interessieren, kÃ¶nnten die Population aber nicht direkt untersuchen, sondern nur einfache Zufallsstichproben der GrÃ¶ÃŸe $n = 10$ ziehen.

* Zur Erinnerung: In diesem Fall ist $h_A=ğœ‹$
]

.pull-right[
.center[
```{r eval = TRUE, echo = F, out.width = "650px"}
knitr::include_graphics("bilder/sampling1.png")
```
]
]

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

**Zufallsschwankungen im SchÃ¤tzwert (Beispiel 1 - AngsststÃ¶rungen)**

.pull-left[
Beispiele fÃ¼r mÃ¶gliche zufÃ¤llig gezogene Stichproben der GrÃ¶ÃŸe $n = 10$ und jeweils resultierender SchÃ¤tzwert $h_S$:

* Stichprobe 1:
  * Messwerte: $x_{1}=0, x_{2}=0, x_{3}=1...$
  * SchÃ¤tzwert: $h_S=0.2$

* Jedes Mal wÃ¼rde aufgrund der zufÃ¤lligen Ziehung der Personen ein zufÃ¤lliger anderer SchÃ¤tzwert resultieren!
]

.pull-right[
.center[
```{r eval = TRUE, echo = F, out.width = "650px"}
knitr::include_graphics("bilder/sampling1.png")
```
]
]

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzwerte:

**Zufallsschwankungen im SchÃ¤tzwert (Beispiel 2 - IQ)**

.center[
```{r eval = TRUE, echo = F, out.width = "750px"}
knitr::include_graphics("bilder/sampling2.png")
```
]

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzfunktionen:

* Das Ziehen einer einfachen Zufallsstichprobe ist ein Zufallsexperiment.

* Das Ergebnis dieses Zufallsexperiments ist eine Stichprobe von $n$ Personen.

* Ein SchÃ¤tzwert ist eine konkrete Zahl und kann fÃ¼r jede dieser Stichproben aus den Realisationen $x_{1}, x_{2}, ..., x_{n}$ der Zufallsvariablen $ğ‘‹_{1}, ğ‘‹_{2}, ..., ğ‘‹_{n}$ berechnet werden.

* Wir kÃ¶nnen also eine Zufallsvariable definieren, die jedem mÃ¶glichen Ergebnis des Zufallsexperiments â€“ also jeder mÃ¶glichen Stichprobe - den aus ihr berechneten SchÃ¤tzwert zuweist.

* Eine solche Zufallsvariable heiÃŸt **SchÃ¤tzfunktion**.

* Der konkrete **SchÃ¤tzwert** ist dann die **Realisation dieser SchÃ¤tzfunktion**.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzfunktionen:

**Beispiel:**

Die zu dem SchÃ¤tzwert

$$\bar{x}=\frac{\sum\limits _{i=1}^{n}x_{i}}{n}$$

gehÃ¶rige SchÃ¤tzfunktion fÃ¼r den Parameter $ğœ‡$ ist die Zufallsvariable

$$\bar{X}=\frac{\sum\limits _{i=1}^{n}X_{i}}{n}$$

Der konkrete SchÃ¤tzwert $\bar{x}$ ist eine Realisation der SchÃ¤tzfunktion $\bar{X}$.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### SchÃ¤tzfunktionen:

* SchÃ¤tzwerte sind Funktionen der Realisationen $x_{i}$ der Zufallsvariablen $X_{i}$

* SchÃ¤tzfunktionen sind Funktionen der Zufallsvariablen $X_{i}$ selbst

VORSICHT:

* SchÃ¤tzfunktionen sind Zufallsvariablen, die allein dadurch zu SchÃ¤tzfunktionen fÃ¼r einen Parameter werden, dass man sie zur SchÃ¤tzung fÃ¼r diesen Parameter verwendet. Das heiÃŸt aber natÃ¼rlich nicht, dass es sich dann automatisch um gute SchÃ¤tzfunktionen fÃ¼r diesen Parameter handelt.

Wir werden in der Inferenzstatistik noch sehr hÃ¤ufig der folgenden Situation begegnen:
* Wir interessieren uns fÃ¼r einen Parameter einer Wahrscheinlichkeitsverteilung.
* FÃ¼r diesen Parameter bestimmen wir eine SchÃ¤tzfunktion.
* Wir ziehen eine einfache Zufallsstichprobe, in der sich die SchÃ¤tzfunktion in einem konkreten SchÃ¤tzwert fÃ¼r den Parameter realisiert.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

* Im Folgenden sei $ğœƒ$ ein beliebiger Parameter einer beliebigen Wahrscheinlichkeitsverteilung und $\hat{ğœƒ}$ eine SchÃ¤tzfunktion fÃ¼r diesen Parameter.

* Wir kÃ¶nnen uns damit nun erst mal unabhÃ¤ngig von einer konkreten Funktion oder eines Parameters Ã¼berlegen, was gegeben sein sollte, damit wir  $\hat{ğœƒ}$ als SchÃ¤tzfunktion $ğœƒ$ verwenden.

Wir betrachten dafÃ¼r folgende drei **GÃ¼tekriterien**:
  * Erwartungstreue (und Genauigkeit)
  * Effizienz
  * Konsistenz

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

**Erwartungstreue:**

Je nachdem, welche konkrete Stichprobe zufÃ¤llig gezogen wird, resultieren unterschiedliche SchÃ¤tzwerte.

* Ein in einer konkreten Stichprobe berechneter SchÃ¤tzwert wird daher in den seltensten FÃ¤llen genau dem wahren Parameterwert entsprechen.

* Wir kÃ¶nnen jedoch fordern, dass die SchÃ¤tzwerte bei unendlicher Wiederholung des Zufallsexperiments - d.h. falls wir unendlich viele einfache Zufallsstichproben der GrÃ¶ÃŸe $n$ ziehen wÃ¼rden - zumindest im Mittel dem wahren Parameterwert entsprechen sollten. Dieses Kriterium wird **Erwartungstreue** genannt.

* Da die SchÃ¤tzwerte Realisationen der SchÃ¤tzfunktion sind, und der Mittelwert unendlich vieler Realisationen einer Zufallsvariable deren Erwartungswert ist, ergibt sich:

* Eine SchÃ¤tzfunktion $\hat{ğœƒ}$ fÃ¼r einen Parameter $ğœƒ$ ist erwartungstreu, falls gilt:

$$E(\hat{ğœƒ})= ğœƒ$$
---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

**Genauigkeit:**

* Wenn $E(\hat{ğœƒ})= ğœƒ$ ist die Anforderung an eine SchÃ¤tzfunktion, dass sie zu mÃ¶glichst â€prÃ¤zisenâ€œ oder â€genauenâ€œ SchÃ¤tzungen fÃ¼hren sollte.

* Bei einer SchÃ¤tzfunktion mit hoher â€Genauigkeitâ€œ wÃ¼rden wir erwarten, dass ihre Realisationen â€“ die SchÃ¤tzwerte - bei wiederholter Ziehung der Stichprobe nur in geringerem AusmaÃŸ um den wahren Parameterwert streuen.

* In diesem Fall liefern nÃ¤mlich viele der mÃ¶glichen zufÃ¤lligen Stichproben einen SchÃ¤tzwert, der nahe an dem wahren Parameterwert liegt.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

**Genauigkeit:**

* Als MaÃŸ fÃ¼r die Genauigkeit einer SchÃ¤tzfunktion kommen also prinzipiell alle StreuungsmaÃŸe fÃ¼r Zufallsvariablen infrage.

* Meistens wird die Standardabweichung $SD(\hat{ğœƒ})$ der SchÃ¤tzfunktion $\hat{ğœƒ}$ betrachtet.
* Diese wird im Fall einer SchÃ¤tzfunktion $\hat{ğœƒ}$ Standardfehler $SE(\hat{ğœƒ})$ von $\hat{ğœƒ}$ genannt:

$$SE(\hat{ğœƒ}) = SD(\hat{ğœƒ})$$

* Je geringer der Standardfehler, desto weniger streuen die SchÃ¤tzwerte und desto genauer ist die SchÃ¤tzfunktion (Erwartungstreue vorausgesetzt).

* Bemerkung: SE kommt von **S**tandard **E**rror, der englischen Bezeichnung fÃ¼r den Standardfehler.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

**Genauigkeit - Beispiel Standardfehler:**

* Der wahre Wert des Parameters sei $ğœƒ$ = 10

* Beispiel fÃ¼r die SchÃ¤tzwerte, die aus einer erwartungstreuen SchÃ¤tzfunktion $\hat{ğœƒ}$ fÃ¼r $ğœƒ$ mit **niedrigem** Standardfehler $SE(\hat{ğœƒ})$ resultieren kÃ¶nnten:

* ZufÃ¤llige Stichprobe 1: $\hat{ğœƒ}_{Wert}$ = 10.3
* ZufÃ¤llige Stichprobe 2: $\hat{ğœƒ}_{Wert}$ = 9.8
* ZufÃ¤llige Stichprobe 3: $\hat{ğœƒ}_{Wert}$ = 10.1
* usw.

$\rightarrow$ Geringe Streuung der SchÃ¤tzwerte $\rightarrow$ die meisten SchÃ¤tzwerte liegen nahe um den wahren Wert $ğœƒ = 10$.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

**Genauigkeit - Beispiel Standardfehler:**

<small>

* Der wahre Wert des Parameters sei $ğœƒ$ = 10

* Beispiel fÃ¼r die SchÃ¤tzwerte, die aus einer erwartungstreuen SchÃ¤tzfunktion $\hat{ğœƒ}$ fÃ¼r $ğœƒ$ mit **hohem** Standardfehler $SE(\hat{ğœƒ})$ resultieren kÃ¶nnten:

* ZufÃ¤llige Stichprobe 1: $\hat{ğœƒ}_{Wert}$ = 52.3
* ZufÃ¤llige Stichprobe 2: $\hat{ğœƒ}_{Wert}$ = -31.8
* ZufÃ¤llige Stichprobe 3: $\hat{ğœƒ}_{Wert}$ = 25.1
* usw.

$\rightarrow$ Starke Streuung der SchÃ¤tzwerte $\rightarrow$ die meisten SchÃ¤tzwerte liegen fern vom wahren Wert $ğœƒ = 10$.

* Da die SchÃ¤tzfunktion erwartungstreu ist, ist der Mittelwert der SchÃ¤tzwerte unendlich vieler Stichproben immer noch gleich dem wahren Wert.

*  Dies hilft uns jedoch nicht wirklich, da wir in der RealitÃ¤t nur eine Stichprobe und daher nur einen SchÃ¤tzwert $\hat{ğœƒ}_{Wert}$ haben. Dieser kann sehr weit weg vom wahren Parameterwert liegen.

</small>

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

**Effizienz:**

Nach diesen VorÃ¼berlegungen kÃ¶nnen wir nun das GÃ¼tekriterium der Effizienz formulieren:

* Eine SchÃ¤tzfunktion ist effizient, falls sie erwartungstreu ist und einen geringeren Standardfehler als alle anderen erwartungstreuen SchÃ¤tzfunktionen aufweist.

* Eine effiziente SchÃ¤tzfunktion ist also die â€prÃ¤zisesteâ€œ SchÃ¤tzfunktion unter allen erwartungstreuen SchÃ¤tzfunktionen.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### GÃ¼tekriterien einer SchÃ¤tzfunktion:

**Konsistenz:**

* Eine weitere wÃ¼nschenswerte Eigenschaft von SchÃ¤tzfunktionen ist, dass sie mit wachsendem Stichprobenumfang n immer â€prÃ¤ziserâ€œ werden.

* Das heiÃŸt: mit wachsendem Stichprobenumfang $n$ sollte der Standardfehler der SchÃ¤tzfunktion immer kleiner werden und schlieÃŸlich gegen Null gehen.

* Formal: Eine erwartungstreue SchÃ¤tzfunktion $\hat{ğœƒ}$ fÃ¼r einen Parameter $ğœƒ$ ist konsistent, falls gilt:

$$\lim_{x \to \infty} SE(\hat{ğœƒ}) = 0]$$
---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Nutzen von Wahrscheinlichkeitsverteilungen zur Quantifizierung des Stichprobenfehlers:

Inferenzstatistik verwendet Stichprobenkennwerte (z.B. Stichprobenmittelwert, Stichprobenvarianz oder auch den Quotient zweier Stichprobenvarianzen) als SchÃ¤tzfunktionen fÃ¼r die entsprechenden Populationsparameter.

* Zieht man immer wieder voneinander unabhÃ¤ngige Zufallsstichproben und berechnet die Kennwerte, werden die einzelnen Kennwerte aufgrund der zufÃ¤lligen Zusammensetzung der Stichproben nicht ident sein 

* Sie streuen zufÃ¤llig um den Erwartungswert. 

* Die Kennwerte einzelner Zufallsstichproben sind Realisierungen von Zufallsvariablen.

* Kenntnis der Verteilung dieser ZV (= Stichprobenverteilung) ist Grundlage fÃ¼r Inferenzstatistik, z.B. von Hypothesentests, Vertrauensbereichen fÃ¼r SchÃ¤tzwerte.

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Nutzen von Wahrscheinlichkeitsverteilungen zur Quantifizierung des Stichprobenfehlers:

.center[
```{r eval = TRUE, echo = F, out.width = "950px"}
knitr::include_graphics("bilder/ki1.png")
```
]

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Nutzen von Wahrscheinlichkeitsverteilungen zur Quantifizierung des Stichprobenfehlers:

* Ziel: Quantifizieren wie gut der Stichprobenkenwert (z.B. Mittelwert) als SchÃ¤tzer fÃ¼r die Population ist

* Anders gesagt: Wie **wahrscheinlich** ist das Ergebnis der SchÃ¤tzfunktion relativ zu allen mÃ¶glichen Ergebnissen

* Vorteil Wahrscheinlichkeitsfunktionen: Werte sind tabelliert und kÃ¶nnen abgelesen werden.



---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Konfidenzintervall

<small>

* Wir interessieren und fÃ¼r einen unbekannten wahren Parameter $Î¸$, der die Verteilung einer Zufallsvariable charakterisiert

* $Î¸$ wird durch eine SchÃ¤tzfunktion $\hat{ğœƒ}$ aus einer (reprÃ¤sentativen) Stichprobe mit Umfang $n$ geschÃ¤tzt

* Es wird davon ausgegangen, dass die Stichprobe in etwa die Grundgesamtheit widerspiegelt, und dass deshalb die SchÃ¤tzung in der NÃ¤he des wahren Parameters liegen mÃ¼sste

* Die SchÃ¤tzfunktion ist selbst eine Zufallsvariable mit einer Verteilung, die den Parameter $Î¸$ enthÃ¤lt

* Bei der SchÃ¤tzung von Parametern geht es nicht nur darum, SchÃ¤tzfunktionen zu finden und deren Eigenschaften (Erwartungstreue, Konsistenz, etc.) abzuklÃ¤ren
* Man mÃ¶chte auch Intervalle angeben, in welchen $Î¸$ mit einer gewissen Sicherheit liegt

* Es sei $Î±$ eine vorgegebene Irrtumswahrscheinlichkeit, und a bzw. b reelle Zahlen, mit a â‰¤ b. Die SchÃ¤tzung des Bereiches $a â‰¤ Î¸ â‰¤ b$ mit der Vertrauenswahrscheinlichkeit $(1 âˆ’ Î±)$ nennen wir Konfidenzintervall des Parameters Î¸ mit Irrtumswahrscheinlichkeit Î±

* $\hat{ğœƒ}$ PunktschÃ¤tzung von $Î¸$, im Vergleich zur IntervallschÃ¤tzung

</small>

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Konfidenzintervall

* Wir konstruieren ein symmetrisches Konfidenzintervall auf Grundlage einer SchÃ¤tzfunktionen $\hat{ğœƒ}$

* Von besonderem Interesse ist die Breite des Konfidenzintervalls. Diese bestimmt sich durch $SE(\hat{ğœƒ})$

* ErwÃ¼nscht ist ein schmales Konfidenzintervall, denn dies weist auf eine genaue SchÃ¤tzung hin

Wir werden folgende Konfidenzintervall rechnen lernen:

* Konfidenzintervall fÃ¼r den Erwartungswert $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei bekannter Varianz $Ïƒ^2$
* Konfidenzintervall fÃ¼r den Erwartungswert $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei unbekannter Varianz $Ïƒ^2$

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### KI fÃ¼r $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei bekannter $Ïƒ^2$

* Die Normalverteilung ist eine reproduzierende Verteilung

1.  Wir ziehen unabhÃ¤ngige Zufallsstichproben vom Umfang $n$ und berechnen in jeder Teilstichprobe den Mittelwert

2. Die Mittelwerte $\bar{x}_n$ aller Zufallsstichproben erzeugen eine Variable $\bar{X}=\frac{1}{n}(X_{1}+X_{2}+...+X_{n})$

3. $\bar{X}$ ist abgesehen von der multiplikativen Konstante $\frac{1}{n}$ eine Summe normalverteilter Variablen, und es gilt

$$\bar{X}~N(Î¼,\frac{Ïƒ^2}{n})$$

* Wenn $X$ normalverteilt ist, hat $\bar{X}$ wiederum Normalverteilung mit dem selben Erwartungswert, aber wesentlich kleinerer Varianz $\frac{Ïƒ^2}{n}$

* Durch ziehen der Wurzel aus der Varianz erhalten wir auch den Standardfehler $SE=\frac{Ïƒ}{\sqrt{n}}$

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### KI fÃ¼r $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei bekannter $Ïƒ^2$

* Wir verwenden die Verteilung von $\bar{X}$ um ein KI fÃ¼r $Î¼$ aufzustellen

* Standardisieren der normalverteilten Variable $\bar{X}$

$$Z=\frac{\bar{X}-Î¼}{\frac{Ïƒ}{\sqrt{n}}}$$

* Es gilt fÃ¼r $(1âˆ’Î±)$% aller Stichproben mit Umfang $n$

$$|\bar{x} - Î¼| \leq z_{1-\frac{Î±}{2}}\frac{Ïƒ}{\sqrt{n}}$$
* Durch Umstellen ergibt sich die Formel fÃ¼r die obere (+) und untere (-) Grenze des Konfidenzintervalls:

$$Î¼_{1,2}=\bar{x} \pm z_{1-\frac{Î±}{2}}\frac{Ïƒ}{\sqrt{n}}$$
---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### KI fÃ¼r $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei bekannter $Ïƒ^2$

**Interpretation des KIs:**

* Die Breite des KI hÃ¤ngt von 3 Faktoren ab: 
  * von der Streuung der Variable $X$ bzw. $Ïƒ$
  * von $n$ 
  * von der Irrtumswahrscheinlichkeit $Î±$ (i.d.R. wÃ¤hlen wir $Î±=.05$)

Was passiert wenn...
* Je kleiner $Ïƒ$, desto enger das KI (geringere Schwankung $\rightarrow$ mehr Konfidenz)
* Je grÃ¶ÃŸer $n$, desto enger das KI (grÃ¶ÃŸere Stichprobe $\rightarrow$ mehr Konfidenz)
* Je kleiner Î±, desto breiter das KI (strengere Irrtumswarhscheinlichkeit $\rightarrow$ mehr Konfidenz)

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### KI fÃ¼r $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei bekannter $Ïƒ^2$

**Beispiel:**

<small>

* Eine Stichprobe von $n = 234$ 14-jÃ¤hrigen SchÃ¼ler:innen wurde mit einem Intelligenztest, der fÃ¼r 14-18 jÃ¤hrige Jugendliche normiert wurde, getestet.

* In der Gesamtpopulation aller Jugendlichen wurde der Test so geeicht, dass die Messwerte normalverteilt mit $Î¼ = 100$ und $Ïƒ = 15$ sind (das entspricht dem StandardmaÃŸ des IQ). $\rightarrow$ Varianz ist bekannt!

* Der Mittelwert der 14-jÃ¤hrigen, der in der Stichprobe gemessen wird, ist $\bar{x}=98.10$

$$Î¼_{1,2}=\bar{x} \pm z_{1-\frac{Î±}{2}}\frac{Ïƒ}{\sqrt{n}}$$

* Der z-Wert fÃ¼r $1-\frac{Î±}{2} = 1-\frac{.05}{2}=1.96$ muss in der z-Tabelle nachgesehen werden. $Î±$ wird halbiert, da sich die 5% Fehler auf die untere und obere Grenze des KIs aufteilen.

$$Î¼_{1,2}=98.10 \pm 1.96\frac{15}{\sqrt{234}}= 98.10 \pm 1.92$$

* $Î¼_{14}$ liegt mit einer Vertrauenswahrscheinlichkeit von .95 im Konfidenzintervall [96.18, 100.02].

</small>

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### KI fÃ¼r $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei unbekannter $Ïƒ^2$

* Unbekannte Varianz $Ïƒ^2$ wird aus den vorliegenden Daten geschÃ¤tzt

$$\hat{\sigma}^2=s^2=\frac{\sum\limits _{i=1}^{n}(x_{i}-\bar{x})^2}{n-1}$$

Anstelle der Standardnormalverteilung...

$$Z=\frac{\bar{X}-Î¼}{\frac{Ïƒ}{\sqrt{n}}} \sim N(0,1)$$ 
...nutzen wir eine leicht abgewandelte Verteilung (T-Verteilung). Die T-Werte berechnen sich analog:

$$T=\frac{\bar{X}-Î¼}{\frac{\hat{Ïƒ}}{\sqrt{n}}} \sim t_{n-1}$$  

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Exkurs t-Verteilung

* Ist Populationsvarianz jedoch nicht bekannt und muss geschÃ¤tzt werden, dann ist der Quotient nicht standardnormalverteilt sondern t-verteilt

* Die t-Verteilung ist wie die NV eingipfelig und symmetrisch (schauen sich sehr Ã¤hnlich)

* Die Form der t-Verteilung ist mitbestimmt durch sog. Freiheitsgrade (df = degrees of freedom). Diese sind leicht zu berechnen:

$$df=n-1$$

* $E(T)=0$ (fÃ¼r $df\geq2$), und Varianz $n/(nâˆ’2)$ (fÃ¼r $df\geq3$)

* Mit wachsender Zahl der Freiheitsgrade (also grÃ¶ÃŸerem $n$) nÃ¤hert sich die t-Verteilung der $N(0,1)$ (sie "approximiert die NV")

* Die Quantile der t-Verteilung kÃ¶nnen bei gegebenem $\alpha$ und $df$ aus der t-Tabelle abgelesen werden ([**Link zur t-Tabelle**](http://eswf.uni-koeln.de/glossar/tvert.htm))

---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### KI fÃ¼r $Î¼$ einer $N(Î¼,Ïƒ^2)$ Variable bei unbekannter $Ïƒ^2$

* Das KI fÃ¼r $Î¼$ ergibt sich also aus

$$\frac{|\bar{X}-Î¼|}{\frac{\hat{Ïƒ}}{\sqrt{n}}} \leq t_{n-1}, df=n-1$$ 
* Mit Irrtumswahrscheinlichkeit $Î±$ gilt

$$|\bar{x} - Î¼| \leq t_{1-\frac{Î±}{2}}\frac{\hat{Ïƒ}}{\sqrt{n}}, df=n-1$$
* Durch Umstellen ergibt sich die Formel fÃ¼r die obere (+) und untere (-) Grenze des Konfidenzintervalls:

$$Î¼_{1,2}=\bar{x} \pm t_{1-\frac{Î±}{2}}\frac{\hat{Ïƒ}}{\sqrt{n}}, df=n-1$$
---
class: top, left
### SchÃ¤tzungen und Stichprobenfehler

#### Beispiel:

* Der Subtest "Rechenaufgaben" eines Intelligenztests wird einer Zufallsstichprobe von $n = 87$ MÃ¼nchner Student:innen vorgegeben

* Gesucht ist das Konfidenzintervall fÃ¼r den Erwartungswert $Î¼$ der Population aller MÃ¼nchner Student:innen

* In der Stichprobe wird eine Mittelwert von $\bar{x}=25.48$ und eine Standardabweichung von $s=6.12$ gemessen

$$Î¼_{1,2}=25.48 \pm t_{1-\frac{Î±}{2}}\frac{6.12}{\sqrt{87}}, df=86$$

* Tabelle enthÃ¤lt keine Eintragung fÃ¼r $df = 86$, aber nÃ¤chtgelegener Wert ist $df = 60$; $t_{0.975} = 2.00$

$$Î¼_{1,2}=25.48 \pm 2.00\frac{6.12}{\sqrt{87}}, df=86$$
* $Î¼_{25.48}$ liegt mit einer  Vertrauenswahrscheinlichkeit von $.95$ im Konfidenzintervall [24.17, 26.79].

---
class: top, left
### Take-aways

.full-width[.content-box-gray[
**Einfache Zufallsstichprobe**
* $n$ Personen werden unabhÃ¤ngig voneinander gezogen
* Jede Person hat die gleiche Wahrscheinlichkeit gezogen zu werden
* Grundlage fÃ¼r Zufallsvariablen

**SchÃ¤tzfunktionen sind Zufallsvariablen**
* fÃ¼r die wir Erwartungswert und Standardabweichung (Standardfehler) berechnen
kÃ¶nnen
* die erwartungstreu, effizient und konsistent sein sollten
* mit deren Hilfe wir Parameter (gesuchter Parameter einer Verteilung entspricht interessierender GrÃ¶ÃŸe in der Population) aus Stichprobendaten schÃ¤tzen

**Konfidenzintervall**
* gibt ein Intervall an, in welchem Parameter zur SchÃ¤tzung des Populationswerts mit einer vorgegebenen Wahrscheinlichkeit (i.d.R. 95%) liegen
]
]


